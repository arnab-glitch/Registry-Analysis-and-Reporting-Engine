<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RegEx Forensic Report - {{ case.case_id }}</title>
    <link rel="stylesheet" href="report_style.css">
</head>

<body>

<!-- ================= HEADER WITH LOGO ================= -->
<header class="header">
    <div class="logo-container">
        <svg width="420" height="140" xmlns="http://www.w3.org/2000/svg">
            <rect width="420" height="140" fill="transparent"/>

            <!-- Neon Circle -->
            <circle cx="210" cy="60" r="38" fill="#111" stroke="#00b7ff" stroke-width="4"/>

            <!-- Your PNG -->
            <image href="regex_logo.png"
                   x="178"
                   y="28"
                   width="64"
                   height="64"
                   preserveAspectRatio="xMidYMid meet"/>
        </svg>

        <h1 class="tool-title">RegEx Forensics</h1>
        <div class="tool-subtitle">
             {{ case.tool_version }} · Developed by Arnab Das
        </div>
    </div>
</header>



<!-- ================= TABS ================= -->
<div class="tabs">

    <button class="tab-button active" onclick="openTab('overview')">Overview</button>
    <button class="tab-button" onclick="openTab('usb')">USB Artifacts</button>
    <button class="tab-button" onclick="openTab('evidence')">Evidence Summary</button>
    <button class="tab-button" onclick="openTab('logs')">Log Output</button>

</div>



<!-- ================= TAB CONTENT: OVERVIEW ================= -->
<section id="overview" class="tab-content active">

    <h2>Case Overview</h2>

    <table class="meta-table">
        <tr><th>Case ID</th><td>{{ case.case_id }}</td></tr>
        <tr><th>Operator</th><td>{{ case.operator }}</td></tr>
        <tr><th>Report Date</th><td>{{ case.report_date }}</td></tr>
        <tr><th>Acquisition Mode</th><td>{{ case.mode }}</td></tr>
        <tr><th>Total Evidence Items</th><td>{{ case.total_files }}</td></tr>
        <tr><th>Manifest Hash (SHA256)</th><td>{{ case.manifest_hash }}</td></tr>
    </table>

    <h2>Analysis Summary</h2>
    <p>{{ analysis.summary }}</p>

    <h3>Key Findings</h3>
    <ul>
        {% for f in analysis.findings %}
        <li>{{ f }}</li>
        {% endfor %}
    </ul>

</section>



<!-- ================= TAB CONTENT: USB ================= -->
<section id="usb" class="tab-content">

    <h2>USB Device History</h2>

    <table class="evidence-table">
        <thead>
            <tr>
                <th>Device Path</th>
                <th>Serial</th>
                <th>Model</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for r in usb %}
            <tr>
                <td>{{ r.device_id }}</td>
                <td>{{ r.serial }}</td>
                <td>{{ r.model }}</td>
                <td>{{ r.action }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>



<!-- ================= TAB CONTENT: EVIDENCE ================= -->
<section id="evidence" class="tab-content">

    <h2>Evidence Items</h2>

    <!-- SEARCH BAR -->
    <input type="text" id="evidence-search" placeholder="Search artifacts..." oninput="filterEvidence()" class="search-input">

    <!-- SCROLLABLE WRAPPER -->
    <div class="evidence-scroll">
    <table class="evidence-table" id="evidence-table">
        <thead>
            <tr>
                <th>Artifact</th>
                <th>Source</th>
                <th>Status</th>
                <th>SHA256</th>
            </tr>
        </thead>
        <tbody>
        {% for i in items %}
            <tr>
                <td>{{ i.artifact }}</td>
                <td>{{ i.source }}</td>
                <td>
                  {% if i.ok %}
                    <span class="badge ok">OK</span>
                  {% else %}
                    <span class="badge fail">FAIL</span>
                  {% endif %}
                </td>
                <td>{{ i.sha256 }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>

</section>





<!-- ================= TAB CONTENT: LOGS ================= -->
<section id="logs" class="tab-content">

    <h2>Acquisition Log Output</h2>
    <pre class="log-block">{{ log_text }}</pre>

</section>



<!-- ================= FOOTER ================= -->
<footer class="footer">
    <p>Generated by RegEx v1.0 · Developed by Arnab Das</p>
</footer>



<!-- ================= JAVASCRIPT ================= -->
<script>
function openTab(tab) {
    document
        .querySelectorAll(".tab-content")
        .forEach(t => t.classList.remove("active"));
    document
        .querySelectorAll(".tab-button")
        .forEach(b => b.classList.remove("active"));

    document.getElementById(tab).classList.add("active");
    event.target.classList.add("active");
}

/* SEARCH FUNCTION FOR EVIDENCE TABLE */
function filterEvidence() {
    let q = document.getElementById("evidence-search").value.toLowerCase();
    let rows = document.querySelectorAll("#evidence-table tbody tr");

    rows.forEach(row => {
        let text = row.innerText.toLowerCase();
        row.style.display = text.includes(q) ? "" : "none";
    });
}
</script>

</body>
</html>
